<VirtualHost *:80>
    ServerName gofins.yourdomain.com
    ServerAdmin webmaster@localhost

    # Logs
    ErrorLog ${APACHE_LOG_DIR}/gofins-error.log
    CustomLog ${APACHE_LOG_DIR}/gofins-access.log combined

    # Authentication
    <Location />
        AuthType Basic
        AuthName "gofins"
        AuthUserFile /opt/gofins/deployment/.htpasswd
        Require valid-user
    </Location>

    # Proxy API requests to Go backend
    ProxyPreserveHost On
    ProxyPass /api http://127.0.0.1:7702/api
    ProxyPassReverse /api http://127.0.0.1:7702/api

    # Pass authenticated user to backend
    RequestHeader set X-Remote-User %{REMOTE_USER}e

    # Proxy everything else to UI
    ProxyPass / http://127.0.0.1:7703/
    ProxyPassReverse / http://127.0.0.1:7703/

    # Enable required modules: proxy, proxy_http, headers
</VirtualHost>
