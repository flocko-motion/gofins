<VirtualHost *:80>
    ServerAdmin webmaster@localhost

    # Logs
    ErrorLog ${APACHE_LOG_DIR}/gofins-error.log
    CustomLog ${APACHE_LOG_DIR}/gofins-access.log combined

    # Authentication for /gofins
    <Location /gofins>
        AuthType Basic
        AuthName "gofins"
        AuthUserFile /opt/gofins/deployment/.htpasswd
        Require valid-user
    </Location>

    # Pass authenticated user to backend
    RequestHeader set X-Remote-User %{REMOTE_USER}e

    # Proxy API requests to Go backend
    ProxyPreserveHost On
    ProxyPass /gofins/api http://127.0.0.1:7702/api
    ProxyPassReverse /gofins/api http://127.0.0.1:7702/api

    # Proxy UI requests
    ProxyPass /gofins http://127.0.0.1:7703/
    ProxyPassReverse /gofins http://127.0.0.1:7703/

    # Enable required modules: proxy, proxy_http, headers
</VirtualHost>
